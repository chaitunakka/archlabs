var formList=void 0,selectedFormID=void 0,userID=void 0,POPUP_OPEN_EVT="popupOpen";
document.addEventListener("DOMContentLoaded",function(){var a=document.getElementById("refresh");a&&a.addEventListener("change",handleAutomaticRefresh);(a=document.getElementById("booknow"))&&a.addEventListener("change",handleAutomaticBookNow);(a=document.getElementById("editForm"))&&a.addEventListener("click",openOrFocusEditDetailsPage);(a=document.getElementById("irctcLink"))&&a.addEventListener("click",function(){chrome.storage.local.set({irctcZapTatkalEnable:!0});window.open("https://www.irctc.co.in",
"_blank")});chrome.storage.local.get("irctcZapTatkalRefresh",initializeAutoRefresh);chrome.storage.local.get("irctcZapTatkalBookNow",initializeAutoBookNow);chrome.storage.local.get("selectedForm",initializeSelectedForm)});function handleAutomaticRefresh(){var a=document.getElementById("refresh");a&&chrome.storage.local.set({irctcZapTatkalRefresh:a.checked})}function handleAutomaticBookNow(){var a=document.getElementById("booknow");a&&chrome.storage.local.set({irctcZapTatkalBookNow:a.checked})}
function guid(){return s4()+s4()+"-"+s4()+"-"+s4()+"-"+s4()+"-"+s4()+s4()+s4()+"-"+(new Date).getTime()}function s4(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function openOrFocusEditDetailsPage(){chrome.extension.getURL("editDetails.html");chrome.tabs.query({},function(){chrome.tabs.create({url:"index.html"})})}
function initializeAutoRefresh(a){var b=!1;a&&(b=a.irctcZapTatkalRefresh);if(a=document.getElementById("refresh"))void 0==b?(chrome.storage.local.set({irctcZapTatkalRefresh:!0}),a.checked=!0):a.checked=b?!0:!1;(b=document.getElementById("refreshLabel"))&&b.MaterialCheckbox&&b.MaterialCheckbox.checkToggleState()}
function initializeAutoBookNow(a){var b=!1;a&&(b=a.irctcZapTatkalBookNow);if(a=document.getElementById("booknow"))void 0==b?(chrome.storage.local.set({irctcZapTatkalBookNow:!0}),a.checked=!0):a.checked=b?!0:!1;(b=document.getElementById("booknowLabel"))&&b.MaterialCheckbox&&b.MaterialCheckbox.checkToggleState()}
function initializeFormList(a){if(a){formList=a.ztFormList;for(a=document.getElementById("formlist");a.lastChild!==a.firstChild;)a.removeChild(a.lastChild);var b=document.createElement("option");b.innerHTML="Select";b.value=-1;a.appendChild(b);if(formList)for(var c in formList)formList.hasOwnProperty(c)&&(b=document.createElement("option"),b.innerHTML=formList[c].formName||"Untitled",b.value=c,a.appendChild(b));a.value=selectedFormID||-1;a.addEventListener("change",changeSelectedForm);updateSelectedTrainDetails()}}
function changeSelectedForm(a){a=a.currentTarget;a.value!=selectedFormID&&(chrome.storage.local.set({selectedForm:a.value}),selectedFormID=a.value);updateSelectedTrainDetails()}
function updateSelectedTrainDetails(){if(selectedFormID&&formList&&formList[selectedFormID]){document.getElementById("formDetails").style.display="";var a=formList[selectedFormID];document.getElementById("from").innerHTML=a.fromStation||"";document.getElementById("to").innerHTML=a.toStation||"";document.getElementById("doj").innerHTML=a.doj||"";document.getElementById("trainNum").innerHTML=a.trainNumber||""}else document.getElementById("formDetails").style.display="none"}
function initializeSelectedForm(a){a&&(selectedFormID=a.selectedForm,chrome.storage.local.get("ztFormList",initializeFormList))}chrome.runtime.sendMessage({track:{event:"page viewed",eventData:{"page name":"ZAPTATKAL_POPUP",url:window.location.pathname}}},function(){});
